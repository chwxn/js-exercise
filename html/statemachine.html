<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>State Machine</title>
    <script src="lib/state-machine.js"></script>
    <script>
        //source:https://github.com/jakesgordon/javascript-state-machines
        var fsm = new StateMachine({
            init: 'solid',
            transitions: [
            { name: 'melt',     from: 'solid',  to: 'liquid' },
            { name: 'freeze',   from: 'liquid', to: 'solid'  },
            { name: 'vaporize', from: 'liquid', to: 'gas'    },
            { name: 'condense', from: 'gas',    to: 'liquid' }
            ],
            methods: {
            onMelt:     function() { console.log('I melted')    },
            onFreeze:   function() { console.log('I froze')     },
            onVaporize: function() { console.log('I vaporized') },
            onCondense: function() { console.log('I condensed') }
            }
        });
        console.log(fsm);
        var fsm1=new StateMachine({
            init:'green',
            transitions:[
                {name:'warn',from:'green',to:'yellow'},
                {name:'stop',from:'yellow',to:'red'},
                {name:'ready',from:'red',to:'yellow'},
                {name:'go',from:'yellow',to:'green'}
            ],
            methods:{
                //transition:
                onWarn:function(){ console.log('tran enter warn') },
                onStop:function(){ console.log('tran enter stop') },
                onReady:function(){ console.log('tran enter ready') },
                onGo:function(){ console.log('tran enter go') },  

                onBeforeWarn:function(){ console.log('tran ---- on before warn'); },
                onAfterWarn:function(){ console.log('tran ---- on after warn'); },
                //state
                onYellow:function(){ console.log('state ---- yellow'); },

                onLeaveGreen:function(){ console.log('state ---- leave green'); },
                onEnterYellow:function(){ console.log('state ---- enter yellow'); },

                //common
                onBeforeTransition:function(lifecycle,arg1,args2){
                    console.log(lifecycle.transition+' '+lifecycle.from+' '+lifecycle.to);
                    console.log(arg1+' '+args2);
                },
                // onBeforeTransition - fired before any transition
                // onLeaveState - fired when leaving any state
                // onTransition - fired during any transition
                // onEnterState - fired when entering any state
                // onAfterTransition - fired after any transition     
            },
        });
        fsm1.observe({
            //observe transition
            onWarn:function(){ console.log('observe: tran enter warn'); },

            onBeforeWarn:function(){ console.log('observe: tran on before warn.'); },
            onAfterWarn:function(){ console.log('observe: tran on after warn.'); },
            //state
            onYellow:function(){ console.log('observe: state yellow'); },

            onLeaveGreen:function(){ console.log('observe: state on leave green'); },
            onEnterYellow:function(){ console.log('observe: state on enter yellow'); },
        });
        console.log(fsm1);
    </script>
</head>
<body style="background-color:#cce8cf">
    
</body>
</html>